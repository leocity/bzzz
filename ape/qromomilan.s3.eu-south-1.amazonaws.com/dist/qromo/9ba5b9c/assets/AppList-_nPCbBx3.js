import{A as $}from"./AppSwitch-DvNn9XTn.js";import{A as q}from"./AppDropdown-sP_yurWJ.js";import{A as E}from"./AppSelect-25W7QIFw.js";import{J as T,_ as A,u as K,D as W,r as h,o as u,c as p,t as y,e as _,a as i,F as B,d as O,n as f,b as U,m as j,G as M,p as Z,g as H,A as G,f as F,i as m,j as J}from"./index-BX7k1nCh.js";import{A as Q}from"./AppButton-CMSLQd3U.js";import{A as X}from"./AppTextInput-fA1Z5gyL.js";import{A as Y}from"./AppPopup-CMC3esdB.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="18854b5d-866b-4a66-81c2-0245b5cef86f",e._sentryDebugIdIdentifier="sentry-dbid-18854b5d-866b-4a66-81c2-0245b5cef86f")}catch{}})();const D="qromomilan",ee="eu-south-1",te="eu-south-1:af70d0a7-d4d8-49a6-8799-677c025ccbf8";function le(e,t,n,o,r,s,a){if(!e)return;let c=e.name.split(".").pop(),d=T(15),g=d+"."+c,x=d+"-full."+c,S="businesses/",w=S+g,k=S+x;AWS.config.update({region:ee,credentials:new AWS.CognitoIdentityCredentials({IdentityPoolId:te})}),C(e,t,n,o,.7,z=>{let l={Bucket:D,Key:k,Body:z,ACL:"public-read",ContentType:e.type};new AWS.S3.ManagedUpload({params:l}).promise().then(function(b){r?C(e,200,200,35*1024,.7,R=>{let L={Bucket:D,Key:w,Body:R,ACL:"public-read",ContentType:e.type};new AWS.S3.ManagedUpload({params:L}).promise().then(function(I){s(g,I)},function(I){console.warn("ERROR uploading image "+e.name+": ",I),a&&a()})}):s(x,b)},function(b){console.warn("ERROR uploading image "+e.name+": ",b),a&&a()})})}function C(e,t,n,o,r,s,a=null,c=1){new Compressor(e,{quality:r,maxWidth:t,maxHeight:n,convertTypes:["image/png"],convertSize:o,success(d){d.size<=o||a===d.size||c>5||t<10||n<10?s(d):C(d,t*.93,n*.93,o,r,s,d.size,c+1)},error(d){console.error(d.message),s(e)}})}const ne={setup(){const e=K(),t=W();return{getString:e.getString,loadScriptsSequence:t.loadScriptsSequence}},emits:["uploading","upload-complete","removed-file"],name:"AppDropzone",components:{AppPopup:Y},data(){return{dropzoneObj:null,options:null,currentFiles:[],popupBodyText:"",ready:!1,allowedFileTypes:["image/jpeg","image/jpg","image/png"]}},props:{label:{type:String,default:null},maxFiles:{type:Number,default:1},maxBytes:{type:Number,default:1024*600},maxWidth:{type:Number,default:1024},maxHeight:{type:Number,default:1024},files:{type:Array,default:[]},createThumbnail:{type:Boolean,default:!1}},methods:{initDropzone(){!this.dropzoneObj&&this.$refs.dropzone&&!this.$refs.dropzone.classList.contains("dz-clickable")?(this.initDropzoneSettings(),this.initDropzoneListeners(),this.currentFiles=this.files):console.warn("Dropzone already initialized")},initDropzoneSettings(){this.options={url:"#",dictDefaultMessage:"",acceptedFiles:"image/jpeg, image/jpg, image/png",maxFiles:this.maxFiles,maxFilesize:1/0,autoProcessQueue:!1,autoDiscover:!1},this.dropzoneObj=new Dropzone(this.$refs.dropzone,this.options)},initDropzoneListeners(){this.dropzoneObj&&(this.dropzoneObj.on("addedfile",this.handleSingleAddFile),this.dropzoneObj.on("addedfiles",this.handleAddFilesAction))},handleSingleAddFile(e){if(this.dropzoneObj.files.length>this.options.maxFiles){this.dropzoneObj.removeFile(e);for(let t=0;t<this.dropzoneObj.files.length;t++)(t>=this.options.maxFiles||!this.allowedFileTypes.includes(this.dropzoneObj.files[t].type))&&this.dropzoneObj.removeFile(this.dropzoneObj.files[t])}else this.allowedFileTypes.includes(e.type)||this.dropzoneObj.removeFile(e)},handleAddFilesAction(e){let t=Object.assign([],Array.prototype.slice.call(e).filter(n=>n.accepted&&!n.error));t.length>0&&(this.$emit("uploading",t),this.filesUploadPopup(t,n=>{n&&n.length&&(this.currentFiles=this.maxFiles===1?[n[0].url]:this.currentFiles.concat(n.map(o=>o.url)),this.$emit("upload-complete",this.currentFiles,e))}))},filesUploadPopup(e,t){this.$refs.popup.toggleStatus(!0);let n=0,o=[],r=s=>{this.popupBodyText=this.getString("wait_for_upload",[n+1+"/"+s.length]);let a="https://qromomilan.s3.eu-south-1.amazonaws.com";le(s[n],this.maxWidth,this.maxHeight,this.maxBytes,this.createThumbnail,c=>{o.push({id:s[n],url:a+"/businesses/"+c}),n++,n<s.length?r(s):(this.popupBodyText=this.getString("upload_complete"),setTimeout(()=>{this.$refs.popup.toggleStatus(!1)},500),t(o))})};r(e)},clickDeleteBtn(e){this.dropzoneObj.removeAllFiles();let t=e.currentTarget.dataset.url;if(this.maxFiles===1)this.currentFiles=[];else{let n=this.currentFiles.indexOf(t);this.currentFiles.splice(n,1)}this.$emit("removed-file",t,this.currentFiles)}},computed:{computedStyle(){return this.maxFiles===1&&this.currentFiles.length?"--image-url-loaded: url("+this.currentFiles[0]+")":""}},mounted(){this.ready=!1,this.loadScriptsSequence(["amazonSdk","imageCompressor","dropzone"],()=>{this.$nextTick(()=>{typeof Dropzone>"u"?setTimeout(()=>{typeof Dropzone>"u"?console.error("Dropzone not loaded"):(this.ready=!0,this.initDropzone())},1e3):(this.ready=!0,this.initDropzone())})})},beforeUnmount(){this.dropzoneObj&&this.dropzoneObj.destroy&&this.dropzoneObj.destroy()},watch:{files(){this.currentFiles=this.files}}},se=["data-files-count"],oe={key:0,class:"txt-input-label"},ie={ref:"dropzone",class:"dropzone"},re={class:"row summary-row"},ae={ref:"summary",class:"summary-extended-container"},ue=["data-url"],de=["src","alt"];function ce(e,t,n,o,r,s){const a=h("AppPopup");return u(),p("div",{class:f(["dropzone-container",{multiple:n.maxFiles>1,disabled:!r.ready}]),style:j(s.computedStyle),"data-files-count":r.currentFiles.length},[n.label?(u(),p("p",oe,y(n.label),1)):_("",!0),i("div",{class:f(["dropzone-wrapper",{filled:r.currentFiles.length}])},[i("div",ie,[i("div",{onClick:t[0]||(t[0]=(...c)=>s.clickDeleteBtn&&s.clickDeleteBtn(...c)),ref:"delete-btn",class:"delete-btn"},null,512)],512),i("div",re,[i("div",ae,[(u(!0),p(B,null,O(r.currentFiles,(c,d)=>(u(),p("div",{key:d,class:"summary-img"},[i("div",{onClick:t[1]||(t[1]=(...g)=>s.clickDeleteBtn&&s.clickDeleteBtn(...g)),"data-url":c,class:"delete-img"},null,8,ue),i("img",{ref_for:!0,ref:"img-"+d,src:c,draggable:"false",alt:"file "+d},null,8,de)]))),128))],512)])],2),U(a,{title:o.getString("uploading"),bodyText:r.popupBodyText,ref:"popup",buttons:[],"prevent-overlay-dismiss":""},null,8,["title","bodyText"])],14,se)}const pe=A(ne,[["render",ce],["__scopeId","data-v-38bc6c19"]]);let V="0752A3";const he={name:"AppColorPicker",emits:["changing-color","changed-color"],data(){return{currentValue:N(this.value),editingTimeout:!1}},props:{name:{type:String,default:"colorPicker"},label:{type:String,default:null},value:{type:String,default:V}},computed:{id(){return"color-picker-"+T()}},methods:{changeColor(e){this.currentValue=e.target.value.replace("#",""),this.$emit("changing-color","#"+this.currentValue),this.editingTimeout&&clearTimeout(this.editingTimeout),this.editingTimeout=setTimeout(()=>{this.$emit("changed-color","#"+this.currentValue),this.editingTimeout=!1},500)}},watch:{value(e){this.currentValue=N(e)}}};function N(e){if(!e)return V;let t=e.replace("#",""),n=/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,o=V;return n.test(t)&&(o=t),o}const me=["for"],fe={key:0,class:"row centered"},ge={class:"txt-input-label"},be={class:"row centered input-element"},ye=["id","name","value"];function _e(e,t,n,o,r,s){return u(),p("label",{for:s.id,ref:"wrapper",class:"input-wrapper",style:j("--selected-color: #"+r.currentValue)},[n.label?(u(),p("div",fe,[i("div",ge,y(n.label),1)])):_("",!0),i("div",be,[i("input",{ref:"input",type:"color",id:s.id,name:n.name,value:"#"+r.currentValue,onInput:t[0]||(t[0]=(...a)=>s.changeColor&&s.changeColor(...a))},null,40,ye)])],12,me)}const ve=A(he,[["render",_e],["__scopeId","data-v-e62293e6"]]),xe={name:"AppNumberInput",emits:["changed-value","pressed-enter"],data(){return{currentValue:0}},props:{label:{type:String,default:null},name:{type:String,default:"input-number"},value:{type:Number,default:0},max:{type:Number,default:null},min:{type:Number,default:null},increment:{type:Number,default:1},doubleDecimal:{type:Boolean,default:!1},symbol:{type:String,default:""},rightSideSymbol:{type:Boolean,default:!1}},methods:{formatInputPrice(e){let t=e&&!isNaN(e)?Number(e):0,n=!isNaN(t)&&parseInt(Number(t))==t&&!isNaN(parseInt(t,10));return Number(t).toFixed(n?0:2)},changeValue(e){let t=Se(e,this.min,this.max);return this.$refs&&this.$refs.input&&(this.doubleDecimal?this.$refs.input.value=this.formatInputPrice(t):this.$refs.input.value=t+""),this.currentValue=t,t},setValue(e){let t=this.changeValue(e);this.$emit("changed-value",t)},pressEnter(e){this.setValue(e.target.value),this.$emit("pressed-enter",this.currentValue)},finishEditing(e){this.setValue(e.target.value)},selectValue(e){e.target.select()}},computed:{id(){return"input-text-"+T()}},mounted(){this.changeValue(this.value)},watch:{value(e){this.changeValue(e)},max(){this.setValue(this.currentValue)},min(){this.setValue(this.currentValue)}}};function Se(e,t,n){let o=e&&!isNaN(e)?Number(e):0;return n!==null&&o>n&&(o=n),t!==null&&o<t&&(o=t),o}const P=e=>(Z("data-v-956fe77f"),e=e(),H(),e),Ae={ref:"wrapper",class:"input-wrapper"},we={key:0,class:"txt-input-label"},ke=["for"],ze={ref:"element",class:"row input-element"},Ie=P(()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14.985",height:"14.985",viewBox:"0 0 14.985 14.985"},[i("path",{d:"M133.812,142.288a1.063,1.063,0,1,1-1.5-1.5l8.477-8.477a1.063,1.063,0,1,1,1.5,1.5Z",transform:"translate(7.493 -186.676) rotate(45)"})],-1)),Fe=[Ie],Ce=["data-symbol"],Ve=["name","id"],Te=P(()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14.985",height:"14.985",viewBox:"0 0 14.985 14.985"},[i("path",{d:"M142.288,142.288a1.073,1.073,0,0,1-1.5,0L137.3,138.8l-3.486,3.486a1.063,1.063,0,1,1-1.5-1.5l3.487-3.487-3.487-3.486a1.063,1.063,0,0,1,1.5-1.5l3.486,3.487,3.487-3.487a1.063,1.063,0,1,1,1.5,1.5L138.8,137.3l3.486,3.487A1.073,1.073,0,0,1,142.288,142.288Z",transform:"translate(7.493 -186.676) rotate(45)"})],-1)),De=[Te];function Ne(e,t,n,o,r,s){return u(),p("div",Ae,[n.label?(u(),p("div",we,[i("label",{for:s.id},y(n.label),9,ke)])):_("",!0),i("div",ze,[i("div",{onClick:t[0]||(t[0]=a=>s.setValue(r.currentValue-n.increment)),class:f(["input-btn minus-btn",{disabled:n.min!==null&&r.currentValue<=n.min}])},Fe,2),i("div",{class:f(["input-number-container",{"right-side-symbol":n.rightSideSymbol}]),"data-symbol":n.symbol},[i("input",{ref:"input",type:"number",inputmode:"decimal",name:n.name,id:s.id,onFocusin:t[1]||(t[1]=(...a)=>s.selectValue&&s.selectValue(...a)),onFocusout:t[2]||(t[2]=(...a)=>s.finishEditing&&s.finishEditing(...a)),onKeyup:t[3]||(t[3]=M((...a)=>s.pressEnter&&s.pressEnter(...a),["enter"]))},null,40,Ve)],10,Ce),i("div",{onClick:t[4]||(t[4]=a=>s.setValue(r.currentValue+n.increment)),class:f(["input-btn plus-btn",{disabled:n.max!==null&&r.currentValue>=n.max}])},De,2)],512)],512)}const Be=A(xe,[["render",Ne],["__scopeId","data-v-956fe77f"]]),Oe={name:"AppList",components:{AppDropzone:pe,AppColorPicker:ve,AppChevronIcon:G,AppTextInput:X,AppNumberInput:Be,AppSwitch:$,AppDropdown:q,AppSelect:E,AppButton:Q},props:{items:{type:Array,required:!0,validator(e){return e&&e.length?e.length>0&&e.every(t=>t.hasOwnProperty("title")):!0}}},data:function(){return{currItems:this.items}},methods:{itemSwitched(e,t){e.active=t,e.callback&&e.callback(t)},clickOnRow(e){e.chevronItem&&this.itemSwitched(e,!e.active)}},watch:{items(e){this.currItems=e}}},je={class:"list-container"},Pe=["onClick"],Re={key:0,class:"extra-text"};function Le(e,t,n,o,r,s){const a=h("AppSwitch"),c=h("AppSelect"),d=h("AppNumberInput"),g=h("AppTextInput"),x=h("AppButton"),S=h("AppColorPicker"),w=h("AppChevronIcon"),k=h("AppDropzone"),z=h("AppDropdown");return u(),p("div",je,[(u(!0),p(B,null,O(e.currItems,(l,v)=>(u(),p("div",{key:l.uniqueId?l.uniqueId:v,class:f(["list-item",{highZ:l.highZ}])},[F(e.$slots,l.customSlot,{item:l,index:v},()=>[i("div",{class:f(["list-item-header",{clickable:!!l.chevronItem}]),onClick:b=>s.clickOnRow(l)},[i("p",{class:f(["list-item-title",{grey:!!l.leftGreyText}])},y(l.title),3),l.switch?(u(),m(a,{key:0,class:"right-item",disabled:!!l.disabled,checked:!!l.active,onSwitched:b=>s.itemSwitched(l,b),ref_for:!0,ref:l.ref?l.ref:"switch"},null,8,["disabled","checked","onSwitched"])):l.selectValues?(u(),m(c,{key:1,class:"right-item",values:l.selectValues,"selected-index":l.selectedIndex,onSelected:l.callbackSelect},null,8,["values","selected-index","onSelected"])):l.numberInput?(u(),m(d,{key:2,class:"right-item",symbol:l.symbol?l.symbol:null,"right-side-symbol":!!l.rightSymbol,value:l.value,min:l.min?l.min:null,max:l.max?l.max:null,"double-decimal":l.doubleDecimal?l.doubleDecimal:!1,onChangedValue:l.callbackNumber},null,8,["symbol","right-side-symbol","value","min","max","double-decimal","onChangedValue"])):l.textInput?(u(),m(g,{key:3,class:"right-item text-wrapper",textarea:!!l.isTextArea,placeholder:l.placeholder||l.value,value:l.value,onChangedText:l.callbackText},null,8,["textarea","placeholder","value","onChangedText"])):l.buttonTitle?(u(),m(x,{key:4,class:"right-item",small:"",outline:"",text:l.buttonTitle,disabled:!!l.buttonDisabled,loading:!!l.buttonLoading,onClick:l.callbackButton},null,8,["text","disabled","loading","onClick"])):l.colorPicker?(u(),m(S,{key:5,class:"right-item",value:l.color,onChangedColor:l.callbackColor},null,8,["value","onChangedColor"])):l.chevronItem?(u(),m(w,{key:6,class:"right-item chevron-icon",direction:l.active?"up":"down"},null,8,["direction"])):l.imageSlot?(u(),m(k,{key:7,class:"right-item","max-bytes":l.maxBytes,"max-width":l.maxWidth?l.maxWidth:1024,"max-height":l.maxHeight?l.maxHeight:1024,files:l.image?[l.image]:[],onRemovedFile:l.callbackRemove,onUploadComplete:l.callbackImage},null,8,["max-bytes","max-width","max-height","files","onRemovedFile","onUploadComplete"])):l.rightText?(u(),p("div",{key:8,class:f(["right-item text-value",{primary:!!l.rightPrimaryText}])},y(l.rightText),3)):_("",!0)],10,Pe)],!0),F(e.$slots,l.headerSlot,{item:l,index:v},()=>[l.explain?(u(),p("div",Re,[i("p",null,y(l.explain),1)])):_("",!0)],!0),l.dropdownSlot?(u(),m(z,{key:0,collapsed:!l.active},{default:J(()=>[F(e.$slots,l.dropdownSlot,{item:l,index:v},void 0,!0)]),_:2},1032,["collapsed"])):_("",!0)],2))),128))])}const He=A(Oe,[["render",Le],["__scopeId","data-v-ca4614a8"]]);export{pe as A,ve as a,Be as b,He as c};
//# sourceMappingURL=AppList-_nPCbBx3.js.map
